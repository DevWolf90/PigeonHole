<%= turbo_stream_from @chat %>


<div class="container chat d-flex flex-column">
  <div>
    <%= link_to chats_path(@chats) do %>
    <i class="fa-solid fa-arrow-left" style="font-size: large;"></i>
    <% end %>
  </div>
 <%# need to fix next line so it says who we're chatting with  %>
 <%# raise %>
 <% sender = @chat.sender  %>
 <% recipient = @chat.recipient %>
 <% if current_user == sender || current_user == recipient %>
  <% chatting_partner = [sender, recipient].reject{ |n| n == current_user } %>
  <h1>You're chatting with @<%=chatting_partner[0].nickname%></h1>

    <% @chat.messages.each do |message| %>
        <%= render 'messages/message', message: message %>
        <% @pigeons.each do |pigeon| %>
          <% if pigeon.description == message.content && pigeon.present?%>
          <%= render "pigeons/pigeoncardwithnodetails", pigeon: pigeon %>
          <% end %>
      <% end %>
    <% end %>
  <%= simple_form_for [@chat, @message],
  html: {class: "d-flex pt-3"} do |f| %>
  <%= f.input :content,
    as: :string,
    label: false,
    placeholder: "Type here",
    wrapper_html: {class: "flex-grow-1"}
  %>
  <%= f.submit "Send", class: "btn btn-primary mb-3" %>
  <% end %>
  <% else %>
  <h1>Get your nosy ass outta here!</h1>
  <% end %>

  </div>

</div>
